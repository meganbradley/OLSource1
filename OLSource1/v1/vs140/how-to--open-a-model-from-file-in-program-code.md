---
title: "How to: Open a Model from File in Program Code"
ms.custom: na
ms.date: "09/22/2016"
ms.prod: "visual-studio-tfs-dev14"
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: "article"
ms.assetid: d7d68697-5418-4263-bdb2-48401924ea71
caps.latest.revision: 12
---
# How to: Open a Model from File in Program Code
You can open DSL models in any application.  
  
 From a [!INCLUDE[vsprvs](../vs140/includes/vsprvs_md.md)] extension, you can use ModelBus for this purpose. ModelBus provides standard mechanism for referencing a model or elements in a model, and for finding the model if it has moved. For more information, see [Integrating DSLs using ModelBus](../vs140/integrating-models-by-using-visual-studio-modelbus.md).  
  
## Target Framework  
 Set the **Target framework** of your application project to **.NET Framework 4**.  
  
#### To set the Target framework  
  
1.  Open the [!INCLUDE[vsprvs](../vs140/includes/vsprvs_md.md)] project for the application in which you want to read a DSL model.  
  
2.  In **Solution Explorer**, right-click the project and then click **Properties**.  
  
3.  In the project properties window, on the **Application** tab, set the **Target framework** field to **.NET Framework 4**.  
  
> [!NOTE]
>  You might need to do this even if you selected **.NET Framework 4** in the project creation dialog box. The target framework should not be **.NET Framework 4 Client Profile**.  
  
## References  
 You have to add these references to your [!INCLUDE[vsprvs](../vs140/includes/vsprvs_md.md)] application project:  
  
-   <CodeContentPlaceHolder>2\</CodeContentPlaceHolder>  
  
    -   If you do not see this under the **.NET** tab in the **Add References** dialog box, click the **Browse** tab and navigate to <CodeContentPlaceHolder>3\</CodeContentPlaceHolder>.  
  
-   Your DSL assembly, which you will find under the bin folder your DSL project. Its name is typically of the form: *YourCompany*.*YourProject*<CodeContentPlaceHolder>4\</CodeContentPlaceHolder>.  
  
## Important Classes in the DSL  
 Before you can write the code that reads your DSL, you should know the names of some of the classes generated by your DSL. In your DSL solution, open the **Dsl** project and look in the **GeneratedCode** folder. Alternatively, double-click the DSL assembly in your project **References**, and open the DSL namespace in **Object Browser**.  
  
 These are the classes that you should identify:  
  
-   *YourDslRootClass* - This is the name of the root class in your <CodeContentPlaceHolder>5\</CodeContentPlaceHolder>.  
  
-   *YourDslName* <CodeContentPlaceHolder>6\</CodeContentPlaceHolder> - This class is defined in <CodeContentPlaceHolder>7\</CodeContentPlaceHolder> in your DSL project.  
  
-   *YourDslName* <CodeContentPlaceHolder>8\</CodeContentPlaceHolder> - This class is defined in <CodeContentPlaceHolder>9\</CodeContentPlaceHolder> in your DSL project.  
  
## Reading from a File  
 The following example is designed to read a DSL in which the important classes are as follows:  
  
-   FamilyTreeModel  
  
-   FamilyTreeSerializationHelper  
  
-   FamilyTreeDomainModel  
  
 The other domain class in this DSL is Person.  
  
<CodeContentPlaceHolder>0\</CodeContentPlaceHolder>  
## Saving to a File  
 The following addition to the previous code makes a change to the model and then saves it to a file.  
  
<CodeContentPlaceHolder>1\</CodeContentPlaceHolder>