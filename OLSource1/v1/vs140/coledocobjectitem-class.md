---
title: "COleDocObjectItem Class"
ms.custom: na
ms.date: "09/22/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: na
ms.suite: na
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: na
ms.topic: "reference"
f1_keywords: 
  - "COleDocObjectItem"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "COleDocObjectItem class"
  - "document object containment"
  - "containment"
  - "containment, doc object"
  - "doc object containment"
ms.assetid: d150d306-8fd3-4831-b06d-afbe71d8fc9b
caps.latest.revision: 22
translation.priority.ht: 
  - "de-de"
  - "ja-jp"
---
# COleDocObjectItem Class
Implements Active document containment.  
  
## Syntax  
  
<CodeContentPlaceHolder>0\</CodeContentPlaceHolder>  
## Members  
  
### Public Constructors  
  
|Name|Description|  
|----------|-----------------|  
|[COleDocObjectItem::COleDocObjectItem](#coledocobjectitem__coledocobjectitem)|Constructs a <CodeContentPlaceHolder>10\</CodeContentPlaceHolder> item.|  
  
### Public Methods  
  
|Name|Description|  
|----------|-----------------|  
|[COleDocObjectItem::DoDefaultPrinting](#coledocobjectitem__dodefaultprinting)|Prints the container application's document using the default printer settings.|  
|[COleDocObjectItem::ExecCommand](#coledocobjectitem__execcommand)|Executes the command specified by the user.|  
|[COleDocObjectItem::GetActiveView](#coledocobjectitem__getactiveview)|Retrieves the document's active view.|  
|[COleDocObjectItem::GetPageCount](#coledocobjectitem__getpagecount)|Retrieves the number of pages in the container application's document.|  
|[COleDocObjectItem::OnPreparePrinting](#coledocobjectitem__onprepareprinting)|Prepares the container application's document for printing.|  
|[COleDocObjectItem::OnPrint](#coledocobjectitem__onprint)|Prints the container application's document.|  
|[COleDocObjectItem::QueryCommand](#coledocobjectitem__querycommand)|Queries for the status of one or more commands generated by user interface events.|  
|[COleDocObjectItem::Release](#coledocobjectitem__release)|Releases the connection to an OLE linked item and closes it if it was open. Does not destroy the client item.|  
  
## Remarks  
 In MFC, an Active document is handled similarly to a regular, in-place editable embedding, with the following differences:  
  
-   The <CodeContentPlaceHolder>11\</CodeContentPlaceHolder>-derived class still maintains a list of the currently embedded items; however, these items may be <CodeContentPlaceHolder>12\</CodeContentPlaceHolder>-derived items.  
  
-   When an active document is active, it occupies the entire client area of the view when it is in-place active.  
  
-   An Active document container has full control of the **Help** menu.  
  
-   The **Help** menu contains menu items for both the Active document container and server.  
  
 Because the Active document container owns the **Help** menu, the container is responsible for forwarding server **Help** menu messages to the server. This integration is handled by <CodeContentPlaceHolder>13\</CodeContentPlaceHolder>.  
  
 For more information on menu merging and Active document activation, see Overview of [Active Document Containment](../vs140/active-document-containment.md).  
  
## Inheritance Hierarchy  
 [CObject](../vs140/cobject-class.md)  
  
 [CCmdTarget](../vs140/ccmdtarget-class.md)  
  
 [CDocItem](../vs140/cdocitem-class.md)  
  
 [COleClientItem](../vs140/coleclientitem-class.md)  
  
 <CodeContentPlaceHolder>14\</CodeContentPlaceHolder>  
  
## Requirements  
 **Header:** afxole.h  
  
##  \<a name="coledocobjectitem__coledocobjectitem">\</a>  COleDocObjectItem::COleDocObjectItem  
 Call this member function to initialize the <CodeContentPlaceHolder>15\</CodeContentPlaceHolder> object.  
  
<CodeContentPlaceHolder>1\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>16\</CodeContentPlaceHolder>  
 A pointer to the <CodeContentPlaceHolder>17\</CodeContentPlaceHolder> object acting as the active document container. This parameter must be **NULL** to enable **IMPLEMENT_SERIALIZE**. Normally OLE items are constructed with a non- **NULL** document pointer.  
  
##  \<a name="coledocobjectitem__dodefaultprinting">\</a>  COleDocObjectItem::DoDefaultPrinting  
 Called by the framework to a document using the default settings.  
  
<CodeContentPlaceHolder>2\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>18\</CodeContentPlaceHolder>  
 A pointer to a [CView](../vs140/cview-class.md) object that is sending the print command.  
  
 <CodeContentPlaceHolder>19\</CodeContentPlaceHolder>  
 A pointer to a [CPrintInfo](../vs140/cprintinfo-structure.md) object that describes the job to be printed.  
  
##  \<a name="coledocobjectitem__execcommand">\</a>  COleDocObjectItem::ExecCommand  
 Call this member function to execute the command specified by the user.  
  
<CodeContentPlaceHolder>3\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>20\</CodeContentPlaceHolder>  
 The identifier of the command to execute. Must be in the group identified by <CodeContentPlaceHolder>21\</CodeContentPlaceHolder>.  
  
 <CodeContentPlaceHolder>22\</CodeContentPlaceHolder>  
 Specifies command-execution options. By default, set to execute the command without prompting the user. See                                 [OLECMDEXECOPT](http://msdn.microsoft.com/library/windows/desktop/ms683930) for a list of values.  
  
 <CodeContentPlaceHolder>23\</CodeContentPlaceHolder>  
 Unique identifier of the command group. By default, **NULL**, which specifies the standard group. The command passed in <CodeContentPlaceHolder>24\</CodeContentPlaceHolder> must belong to the group.  
  
### Return Value  
 Returns <CodeContentPlaceHolder>25\</CodeContentPlaceHolder> if successful; otherwise,returns one of the following error codes.  
  
|Value|Description|  
|-----------|-----------------|  
|**E_UNEXPECTED**|Unexpected error occurred.|  
|**E_FAIL**|Error occurred.|  
|**E_NOTIMPL**|Indicates MFC itself should attempt to translate and dispatch the command.|  
|**OLECMDERR_E_UNKNOWNGROUP**|<CodeContentPlaceHolder>26\</CodeContentPlaceHolder> is non- **NULL** but does not specify a recognized command group.|  
|**OLECMDERR_E_NOTSUPPORTED**|<CodeContentPlaceHolder>27\</CodeContentPlaceHolder> is not recognized as a valid command in the group pGroup.|  
|**OLECMDERR_DISABLED**|The command identified by <CodeContentPlaceHolder>28\</CodeContentPlaceHolder> is disabled and cannot be executed.|  
|**OLECMDERR_NOHELP**|Caller asked for help on the command identified by <CodeContentPlaceHolder>29\</CodeContentPlaceHolder> but no help is available.|  
|**OLECMDERR_CANCELLED**|User canceled the execution.|  
  
### Remarks  
 The <CodeContentPlaceHolder>30\</CodeContentPlaceHolder> and the <CodeContentPlaceHolder>31\</CodeContentPlaceHolder> parameters together uniquely identify the command to invoke. The <CodeContentPlaceHolder>32\</CodeContentPlaceHolder> parameter specifies the exact action to take.  
  
##  \<a name="coledocobjectitem__getactiveview">\</a>  COleDocObjectItem::GetActiveView  
 Call this member function to get a pointer to the <CodeContentPlaceHolder>33\</CodeContentPlaceHolder> interface of the currently active view.  
  
<CodeContentPlaceHolder>4\</CodeContentPlaceHolder>  
### Return Value  
 A pointer to the                         [IOleDocumentView](http://msdn.microsoft.com/library/windows/desktop/ms678455) interface of the currently active view. If there is no current view, it returns **NULL**.  
  
### Remarks  
 The reference count on the returned <CodeContentPlaceHolder>34\</CodeContentPlaceHolder> pointer is not incremented before it is returned by this function.  
  
##  \<a name="coledocobjectitem__getpagecount">\</a>  COleDocObjectItem::GetPageCount  
 Call this member function to retrieve the number of pages in the document.  
  
<CodeContentPlaceHolder>5\</CodeContentPlaceHolder>  
### Parameters  
 *pnFirstPage*  
 A pointer to the number of the document's first page. Can be **NULL**, which indicates the caller doesn't need this number.  
  
 *pcPages*  
 A pointer to the total number of pages in the document. Can be **NULL**, which indicates the caller doesn't need this number.  
  
### Return Value  
 Nonzero if successful; otherwise 0.  
  
##  \<a name="coledocobjectitem__onprepareprinting">\</a>  COleDocObjectItem::OnPreparePrinting  
 This member function is called by the framework to prepare a document for printing.  
  
<CodeContentPlaceHolder>6\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>35\</CodeContentPlaceHolder>  
 A pointer to a [CView](../vs140/cview-class.md) object that is sending the print command.  
  
 <CodeContentPlaceHolder>36\</CodeContentPlaceHolder>  
 A pointer to a [CPrintInfo](../vs140/cprintinfo-structure.md) object that describes the job to be printed.  
  
 <CodeContentPlaceHolder>37\</CodeContentPlaceHolder>  
 Specifies whether the entire document is to be printed.  
  
### Return Value  
 Nonzero if successful; otherwise 0.  
  
##  \<a name="coledocobjectitem__onprint">\</a>  COleDocObjectItem::OnPrint  
 This member function is called by the framework to print a document.  
  
<CodeContentPlaceHolder>7\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>38\</CodeContentPlaceHolder>  
 A pointer to a CView object that is sending the print command.  
  
 <CodeContentPlaceHolder>39\</CodeContentPlaceHolder>  
 A pointer to a [CPrintInfo](../vs140/cprintinfo-structure.md) object that describes the job to be printed.  
  
 <CodeContentPlaceHolder>40\</CodeContentPlaceHolder>  
 Specifies whether the entire document is to be printed.  
  
##  \<a name="coledocobjectitem__querycommand">\</a>  COleDocObjectItem::QueryCommand  
 Queries for the status of one or more commands generated by user interface events.  
  
<CodeContentPlaceHolder>8\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>41\</CodeContentPlaceHolder>  
 identifier of the command being queried for.  
  
 <CodeContentPlaceHolder>42\</CodeContentPlaceHolder>  
 A pointer to the flags returned as a result of the query. For a list of possible values, see                                 [OLECMDF](http://msdn.microsoft.com/library/windows/desktop/ms695237).  
  
 <CodeContentPlaceHolder>43\</CodeContentPlaceHolder>  
 Pointer to an                                 [OLECMDTEXT](http://msdn.microsoft.com/library/windows/desktop/ms693314) structure in which to return name and status information for a single command. Can be **NULL** to indicate that the caller does not need this information.  
  
 <CodeContentPlaceHolder>44\</CodeContentPlaceHolder>  
 Unique identifier of the command group; can be **NULL** to specify the standard group.  
  
### Return Value  
 For a complete listing of return values, see                         [IOleCommandTarget::QueryStatus](http://msdn.microsoft.com/library/windows/desktop/ms688491) in the [!INCLUDE[winSDK](../vs140/includes/winsdk_md.md)].  
  
### Remarks  
 This member function emulates the functionality of the                         [IOleCommandTarget::QueryStatus](http://msdn.microsoft.com/library/windows/desktop/ms688491) method, as described in the [!INCLUDE[winSDK](../vs140/includes/winsdk_md.md)].  
  
##  \<a name="coledocobjectitem__release">\</a>  COleDocObjectItem::Release  
 Releases the connection to an OLE linked item and closes it if it was open. Does not destroy the client item.  
  
<CodeContentPlaceHolder>9\</CodeContentPlaceHolder>  
### Parameters  
 <CodeContentPlaceHolder>45\</CodeContentPlaceHolder>  
 Flag specifying under what circumstances the OLE item is saved when it returns to the loaded state. For a list of possible values, see [COleClientItem::Close](../vs140/coleclientitem-class.md#coleclientitem__close).  
  
### Remarks  
 Does not destroy the client item.  
  
## See Also  
 [MFC Sample MFCBIND](../vs140/visual-c---samples.md)   
 [Base Class](../vs140/coleclientitem-class.md)   
 [Hierarchy Chart](../vs140/hierarchy-chart.md)   
 [COleClientItem](../vs140/coleclientitem-class.md)   
 [CDocObjectServerItem](../vs140/cdocobjectserveritem-class.md)