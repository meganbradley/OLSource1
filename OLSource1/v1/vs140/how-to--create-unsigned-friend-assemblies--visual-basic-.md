---
title: "How to: Create Unsigned Friend Assemblies (Visual Basic)"
ms.custom: na
ms.date: "09/22/2016"
ms.reviewer: na
ms.suite: na
ms.technology: 
  - "devlang-visual-basic"
ms.tgt_pltfrm: na
ms.topic: "article"
dev_langs: 
  - "VB"
ms.assetid: 5735eb79-9729-4c46-ac1f-537ada3acaa7
caps.latest.revision: 6
---
# How to: Create Unsigned Friend Assemblies (Visual Basic)
This example shows how to use friend assemblies with assemblies that are unsigned.  
  
### To create an assembly and a friend assembly  
  
1.  Open a command prompt.  
  
2.  Create a Visual Basic file named <CodeContentPlaceHolder>4\</CodeContentPlaceHolder> that contains the following code. The code uses the \<xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute*> attribute to declare friend_signed_B as a friend assembly.  
  
<CodeContentPlaceHolder>0\</CodeContentPlaceHolder>  
3.  Compile and sign friend_signed_A by using the following command.  
  
<CodeContentPlaceHolder>1\</CodeContentPlaceHolder>  
4.  Create a Visual Basic file named <CodeContentPlaceHolder>5\</CodeContentPlaceHolder> that contains the following code. Because friend_unsigned_A specifies friend_unsigned_B as a friend assembly, the code in friend_unsigned_B can access <CodeContentPlaceHolder>6\</CodeContentPlaceHolder> types and members from friend_unsigned_A.  
  
<CodeContentPlaceHolder>2\</CodeContentPlaceHolder>  
5.  Compile friend_signed_B by using the following command.  
  
<CodeContentPlaceHolder>3\</CodeContentPlaceHolder>  
     The name of the assembly that is generated by the compiler must match the friend assembly name that is passed to the \<xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute*> attribute. You can explicitly set the assembly by using the <CodeContentPlaceHolder>7\</CodeContentPlaceHolder> compiler option.  
  
6.  Run the friend_signed_B.exe file.  
  
     The program prints two strings: "Class1.Test" and "Class2.Test".  
  
## .NET Framework Security  
 There are similarities between the \<xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute*> attribute and the \<xref:System.Security.Permissions.StrongNameIdentityPermission*> class. The main difference is that \<xref:System.Security.Permissions.StrongNameIdentityPermission*> can demand security permissions to run a particular section of code, whereas the \<xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute*> attribute controls the visibility of <CodeContentPlaceHolder>8\</CodeContentPlaceHolder> types and members.  
  
## See Also  
 \<xref:System.Runtime.CompilerServices.InternalsVisibleToAttribute*>   
 [Assemblies and the Global Assembly Cache (Visual Basic)](../vs140/assemblies-and-the-global-assembly-cache--visual-basic-.md)   
 [Friend Assemblies (Visual Basic)](../vs140/friend-assemblies--visual-basic-.md)   
 [How to: Create Signed Friend Assemblies (Visual Basic)](../vs140/how-to--create-signed-friend-assemblies--visual-basic-.md)   
 [Visual Basic Programming Guide](../vs140/visual-basic-programming-guide.md)