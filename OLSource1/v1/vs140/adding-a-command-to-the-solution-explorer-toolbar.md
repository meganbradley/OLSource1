---
title: "Adding a Command to the Solution Explorer Toolbar"
ms.custom: na
ms.date: "09/22/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: na
ms.suite: na
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: na
ms.topic: "article"
helpviewer_keywords: 
  - "toolbars [Visual Studio], adding buttons"
  - "buttons [Visual Studio], adding to Solution Explorer"
  - "Solution Explorer, adding buttons"
ms.assetid: f6411557-2f4b-4e9f-b02e-fce12a6ac7e9
caps.latest.revision: 43
ms.author: "gregvanl"
translation.priority.mt: 
  - "de-de"
  - "ja-jp"
---
# Adding a Command to the Solution Explorer Toolbar
This walkthrough shows how to add a button to the **Solution Explorer** toolbar.  
  
 Any command on a toolbar or menu is called a button in Visual Studio. When the button is clicked, the code in the command handler is executed. Typically, related commands are grouped together to form one group. Menus or toolbars act as containers for groups. Priority determines the order in which individual commands in a group appear in the menu or on the toolbar. You can prevent a button from being displayed on the toolbar or the menu by controlling its visibility. A command that is listed in a <CodeContentPlaceHolder>5\</CodeContentPlaceHolder> section of the .vsct file appears only in the associated context. The visibility cannot be applied to groups.  
  
 For more information about menus, toolbar commands, and .vsct files, see [Menus and Toolbars](../vs140/commands--menus--and-toolbars.md).  
  
> [!NOTE]
>  Use XML Command Table (.vsct) files instead of command table configuration (.ctc) files to define how menus and commands appear in your VSPackages. For more information, see [XML-Based Command Table Configuration (.vsct) Files](../vs140/visual-studio-command-table--.vsct--files.md).  
  
## Prerequisites  
 Starting in Visual Studio 2015, you do not install the Visual Studio SDK from the download center. It is included as an optional feature in Visual Studio setup. You can also install the VS SDK later on. For more information, see [Installing the Visual Studio SDK](../vs140/installing-the-visual-studio-sdk.md).  
  
## Creating an Extension with a Menu Command  
 Create a VSIX project named <CodeContentPlaceHolder>6\</CodeContentPlaceHolder>. Add a menu command item template named **ToolbarButton**. For information about how to do this, see [Creating an Extension with a Menu Command](../vs140/creating-an-extension-with-a-menu-command.md).  
  
## Adding a Button to the Solution Explorer Toolbar  
 This section of the walkthrough shows how to add a button to the **Solution Explorer** toolbar. When the button is clicked, the code in the callback method is run.  
  
1.  In the ToolbarButtonPackage.vsct file, go to the  <CodeContentPlaceHolder>7\</CodeContentPlaceHolder> section. The <CodeContentPlaceHolder>8\</CodeContentPlaceHolder>  node contains the menu group and command that was generated by the package template. Add an <CodeContentPlaceHolder>9\</CodeContentPlaceHolder> element to this node to declare the group that will hold your command.  
  
<CodeContentPlaceHolder>0\</CodeContentPlaceHolder>  
2.  In the <CodeContentPlaceHolder>10\</CodeContentPlaceHolder> section, after the existing group entry, define the new group that you declared in the previous step.  
  
<CodeContentPlaceHolder>1\</CodeContentPlaceHolder>  
     Setting the parent GUID:ID pair to <CodeContentPlaceHolder>11\</CodeContentPlaceHolder> and <CodeContentPlaceHolder>12\</CodeContentPlaceHolder> puts this group on the **Solution Explorer** toolbar, and setting a high-priority value puts it after the other command groups.  
  
3.  In the <CodeContentPlaceHolder>13\</CodeContentPlaceHolder> section, change the parent ID of the generated <CodeContentPlaceHolder>14\</CodeContentPlaceHolder> entry to reflect the group that you defined in the previous step. The modified <CodeContentPlaceHolder>15\</CodeContentPlaceHolder> element should look like this:  
  
<CodeContentPlaceHolder>2\</CodeContentPlaceHolder>  
4.  Build the project and start debugging. The experimental instance appears.  
  
     The **Solution Explorer** toolbar should display the new command button to the right of the existing buttons. The button icon is the strikethrough.  
  
5.  Click the new button.  
  
     A dialog box that has the message **ToolbarButtonPackage Inside SolutionToolbar.ToolbarButton.MenuItemCallback()** should be displayed.  
  
## Controlling the Visibility of a Button  
 This section of the walkthrough shows how to control the visibility of a button on a toolbar. By setting a context to one or more projects in the <CodeContentPlaceHolder>16\</CodeContentPlaceHolder> section of the SolutionToolbar.vsct file, you restrict a button to appear only when a project or projects are open.  
  
#### To display a button when one or more projects are open  
  
1.  In the <CodeContentPlaceHolder>17\</CodeContentPlaceHolder> section of ToolbarButtonPackage.vsct, add two command flags to the existing <CodeContentPlaceHolder>18\</CodeContentPlaceHolder> element, between the <CodeContentPlaceHolder>19\</CodeContentPlaceHolder> and <CodeContentPlaceHolder>20\</CodeContentPlaceHolder> tags.  
  
<CodeContentPlaceHolder>3\</CodeContentPlaceHolder>  
     The <CodeContentPlaceHolder>21\</CodeContentPlaceHolder> and <CodeContentPlaceHolder>22\</CodeContentPlaceHolder> flags must be set so that entries in the <CodeContentPlaceHolder>23\</CodeContentPlaceHolder> section can take effect.  
  
2.  Create a <CodeContentPlaceHolder>24\</CodeContentPlaceHolder> section that has two <CodeContentPlaceHolder>25\</CodeContentPlaceHolder> entries. Put the new section just after the closing <CodeContentPlaceHolder>26\</CodeContentPlaceHolder> tag.  
  
<CodeContentPlaceHolder>4\</CodeContentPlaceHolder>  
     Each visibility item represents a condition under which the specified button is displayed. To apply multiple conditions, you must create multiple entries for the same button.  
  
3.  Build the project and start debugging. The experimental instance appears.  
  
     The **Solution Explorer** toolbar does not contain the strikethrough button.  
  
4.  Open any solution that contains a project.  
  
     The strikethrough button appears on the toolbar to the right of the existing buttons.  
  
5.  On the **File** menu, click **Close Solution**. The button disappears from the toolbar.  
  
 The visibility of the button is controlled by [!INCLUDE[vsprvs](../vs140/includes/vsprvs_md.md)] until the VSPackage is loaded. After the VSPackage is loaded, the visibility of the button is controlled by the VSPackage.  For more information, see [How to: Create and Handle Commands in VSPackages (C#)](../vs140/menucommands-vs.-olemenucommands.md).  
  
## See Also  
 [Menu and Toolbar Commands](../vs140/commands--menus--and-toolbars.md)