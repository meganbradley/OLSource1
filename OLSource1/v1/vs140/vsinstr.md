---
title: "VSInstr"
ms.custom: na
ms.date: "09/22/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: na
ms.suite: na
ms.technology: 
  - "vs-ide-debug"
ms.tgt_pltfrm: na
ms.topic: "article"
helpviewer_keywords: 
  - "performance tools, instrumentation"
  - "instrumentation, VSInstr tool"
  - "profiling tools,VSInstr"
  - "command-line tools, instrumentation"
  - "command line, tools"
  - "VSInstr"
  - "VSInstr tool"
  - "performance tools, VSInstr tool"
ms.assetid: 7b1334f7-f9b0-4a82-a145-d0607bfa8467
caps.latest.revision: 48
translation.priority.ht: 
  - "de-de"
  - "ja-jp"
---
# VSInstr
VSInstr tool is used to instrument binaries. It is invoked by using the following syntax:  
  
<CodeContentPlaceHolder>0\</CodeContentPlaceHolder>  
 The following table describes VSInstr tool options:  
  
|Options|Description|  
|-------------|-----------------|  
|**Help** or **?**|Displays help.|  
|**U**|Writes the redirected console output as Unicode. It must be first option specified.|  
|<CodeContentPlaceHolder>1\</CodeContentPlaceHolder>|Specifies the name of a response file that contains one command option per line.  Do not use quotation marks.|  
|**OutputPath** <CodeContentPlaceHolder>2\</CodeContentPlaceHolder>|Specifies a destination directory for the instrumented image. If an output path is not specified, the original binary is renamed by appending "Orig" to the file name in the same directory, and a copy of the binary is instrumented.|  
|**Exclude** <CodeContentPlaceHolder>3\</CodeContentPlaceHolder>|Specifies a function specification to exclude from instrumentation by probes. It is useful when profiling probe insertion in a function causes unpredictable or unwanted results.\<br />\<br /> Do not use **Exclude** and **Include** options that refer to functions in the same binary.\<br />\<br /> You can specify multiple function specification with separate **Exclude** options.\<br />\<br /> <CodeContentPlaceHolder>4\</CodeContentPlaceHolder> is a defined as:\<br />\<br /> [namespace\<separator1>] [class\<separator2>]function\<br />\<br /> \<separator1> is <CodeContentPlaceHolder>5\</CodeContentPlaceHolder> for native code, and <CodeContentPlaceHolder>6\</CodeContentPlaceHolder> for managed code.\<br />\<br /> \<separator2> is always <CodeContentPlaceHolder>7\</CodeContentPlaceHolder>\<br />\<br /> **Exclude** is supported with code coverage.\<br />\<br /> The wildcard character \* is supported. For example, to exclude all functions in a namespace use:\<br />\<br /> MyNamespace::\*\<br />\<br /> You can use **VSInstr /DumpFuncs** to list the complete names of functions in the specified binary.|  
|**Include** <CodeContentPlaceHolder>8\</CodeContentPlaceHolder>|Specifies a function specification in a binary to instrument with probes. All other functions in the binaries are not instrumented.\<br />\<br /> You can specify multiple function specifications with separate **Include** options.\<br />\<br /> Do not use **Include** and **Exclude** options that refer to functions in the same binary.\<br />\<br /> **Include** is not supported with code coverage.\<br />\<br /> <CodeContentPlaceHolder>9\</CodeContentPlaceHolder> is a defined as:\<br />\<br /> [namespace\<separator1>] [class\<separator2>]function\<br />\<br /> \<separator1> is <CodeContentPlaceHolder>10\</CodeContentPlaceHolder> for native code, and <CodeContentPlaceHolder>11\</CodeContentPlaceHolder> for managed code.\<br />\<br /> \<separator2> is always <CodeContentPlaceHolder>12\</CodeContentPlaceHolder>\<br />\<br /> The wildcard character \* is supported. For example, to include all functions in a namespace use:\<br />\<br /> MyNamespace::\*\<br />\<br /> You can use **VSInstr /DumpFuncs** to list the complete names of functions in the specified binary.|  
|**DumpFuncs**|Lists the functions within the specified image. No instrumentation is performed.|  
|**ExcludeSmallFuncs**|Excludes small functions, which are short functions that do not make any function calls, from instrumentation. The **ExcludeSmallFuncs** option provides for less instrumentation overhead a thus improved instrumentation speed.\<br />\<br /> The exclusion of small functions also reduces the .vsp file size and time required for analysis.|  
|**Mark:**{**Before**<CodeContentPlaceHolder>13\</CodeContentPlaceHolder>**After**<CodeContentPlaceHolder>14\</CodeContentPlaceHolder>**Top**<CodeContentPlaceHolder>15\</CodeContentPlaceHolder>**Bottom**}<CodeContentPlaceHolder>16\</CodeContentPlaceHolder>|Inserts a profile mark (an identifier used to delimit the data in reports) that you can use to identify the start or end of a data range in the .vsp report file.\<br />\<br /> **Before** - Immediately before the target function entry.\<br />\<br /> **After** - Immediately after the target function exit.\<br />\<br /> **Top** - Immediately after the target function entry.\<br />\<br /> **Bottom** - Immediately before each return in the target function.\<br />\<br /> <CodeContentPlaceHolder>17\</CodeContentPlaceHolder> - Name of the target function\<br />\<br /> <CodeContentPlaceHolder>18\</CodeContentPlaceHolder> - A positive integer (long) to use as the identifier of the profile mark.|  
|**Coverage**|Performs coverage instrumentation. It can be It can be used only with the following options: **Verbose**, **OutputPath**, **Exclude**, and **Logfile**..|  
|**Verbose**|The **Verbose**option is used to view detailed information about the instrumentation process.|  
|**NoWarn** <CodeContentPlaceHolder>19\</CodeContentPlaceHolder>|Suppress all or specific warnings.\<br />\<br /> <CodeContentPlaceHolder>20\</CodeContentPlaceHolder> - the warning number. If <CodeContentPlaceHolder>21\</CodeContentPlaceHolder> is omitted, all warnings are suppressed.\<br />\<br /> For more information, see [VSInstr Warnings](../vs140/vsinstr-warnings.md).|  
|**Control** <CodeContentPlaceHolder>22\</CodeContentPlaceHolder> **Thread** <CodeContentPlaceHolder>23\</CodeContentPlaceHolder> **Process** <CodeContentPlaceHolder>24\</CodeContentPlaceHolder> **Global** <CodeContentPlaceHolder>25\</CodeContentPlaceHolder>|Specifies the profiling level of the following VSInstr data collection control Options:\<br />\<br /> **Start**\<br />\<br /> **StartOnly**\<br />\<br /> **Suspend**\<br />\<br /> **StopOnly**\<br />\<br /> **SuspendOnly**\<br />\<br /> **ResumeOnly**\<br />\<br /> **Thread** - specifies thread-level data collection control functions. Profiling is started or stopped only for the current thread. The profiling state of other threads is not affected. The default is thread.\<br />\<br /> **Process** - specifies process-level profiling data collection control functions. Profiling starts or stops for all threads in the current process. The profiling state of other processes is not affected.\<br />\<br /> **Global** - specifies global-level (cross-process) data collection control functions.\<br />\<br /> An error occurs if you do not specify the profiling level.|  
|**Start** <CodeContentPlaceHolder>26\</CodeContentPlaceHolder> **Inside** <CodeContentPlaceHolder>27\</CodeContentPlaceHolder> **Outside** <CodeContentPlaceHolder>28\</CodeContentPlaceHolder>|Limits data collection to the target function and child functions called by that function.\<br />\<br /> **Inside** - Inserts the StartProfile function immediately after the entry to the target function. Inserts the StopProfile function immediately before each return in the target function.\<br />\<br /> **Outside** - Inserts the StartProfile function immediately before each call to the target function. Inserts the StopProfile function immediately after each call to the target function.\<br />\<br /> <CodeContentPlaceHolder>29\</CodeContentPlaceHolder> - the name of the target function.|  
|**Suspend** <CodeContentPlaceHolder>30\</CodeContentPlaceHolder> **Inside** <CodeContentPlaceHolder>31\</CodeContentPlaceHolder> **Outside** <CodeContentPlaceHolder>32\</CodeContentPlaceHolder>|Excludes data collection for the target function and child functions called by the function.\<br />\<br /> **Inside** - Inserts the SuspendProfile function immediately after the entry to the target function. Inserts the ResumeProfile function immediately before each return in the target function.\<br />\<br /> **Outside** - Inserts the SuspendProfile function immediately before the entry to the target function. Inserts the ResumeProfile function immediately after the exit from the target function.\<br />\<br /> <CodeContentPlaceHolder>33\</CodeContentPlaceHolder> - name of the target function.\<br />\<br /> If the target function contains a StartProfile function, the SuspendProfile function is inserted before it. If the target function contains a StopProfile function, the ResumeProfile function is inserted after it.|  
|**StartOnly:** <CodeContentPlaceHolder>34\</CodeContentPlaceHolder> **Before** <CodeContentPlaceHolder>35\</CodeContentPlaceHolder> **After** <CodeContentPlaceHolder>36\</CodeContentPlaceHolder> **Top** <CodeContentPlaceHolder>37\</CodeContentPlaceHolder> **Bottom** <CodeContentPlaceHolder>38\</CodeContentPlaceHolder>|Begins data collection during a profiling run. It inserts the StartProfile API function at the specified location.\<br />\<br /> **Before** - immediately before the target function entry.\<br />\<br /> **After** - immediately after the target function exit.\<br />\<br /> **Top** - immediately after the target function entry.\<br />\<br /> **Bottom** - immediately before each return in the target function.\<br />\<br /> <CodeContentPlaceHolder>39\</CodeContentPlaceHolder> - name of the target function.|  
|**StopOnly:**{**Before**<CodeContentPlaceHolder>40\</CodeContentPlaceHolder>**After**<CodeContentPlaceHolder>41\</CodeContentPlaceHolder>**Top**<CodeContentPlaceHolder>42\</CodeContentPlaceHolder>**Bottom**}<CodeContentPlaceHolder>43\</CodeContentPlaceHolder>|Halts data collection during a profiling run. It inserts the StopProfile function at the specified location.\<br />\<br /> **Before** - immediately before the target function entry.\<br />\<br /> **After** - immediately after the target function exit.\<br />\<br /> **Top** - immediately after the target function entry.\<br />\<br /> **Bottom** - immediately before each return in the target function.\<br />\<br /> <CodeContentPlaceHolder>44\</CodeContentPlaceHolder> - name of the target function.|  
|**SuspendOnly:**{**Before**<CodeContentPlaceHolder>45\</CodeContentPlaceHolder>**After**<CodeContentPlaceHolder>46\</CodeContentPlaceHolder>**Top**<CodeContentPlaceHolder>47\</CodeContentPlaceHolder>**Bottom**}<CodeContentPlaceHolder>48\</CodeContentPlaceHolder>|Halts data collection during a profiling run. It inserts the SuspendProfile API at the specified location.\<br />\<br /> **Before** - immediately before the target function entry.\<br />\<br /> **After** - immediately after the target function exit.\<br />\<br /> **Top** - immediately after the target function entry.\<br />\<br /> **Bottom** - immediately before each return in the target function.\<br />\<br /> <CodeContentPlaceHolder>49\</CodeContentPlaceHolder> - name of the target function.\<br />\<br /> If the target function contains a StartProfile function, the SuspendProfile function is inserted before it.|  
|**ResumeOnly:**{**Before**<CodeContentPlaceHolder>50\</CodeContentPlaceHolder>**After**<CodeContentPlaceHolder>51\</CodeContentPlaceHolder>**Top**<CodeContentPlaceHolder>52\</CodeContentPlaceHolder>**Bottom**}<CodeContentPlaceHolder>53\</CodeContentPlaceHolder>|Begins or resumes data collection during a profiling run.\<br />\<br /> It is usually used to start profiling after a **SuspendOnly** option has stopped profiling. It inserts a ResumeProfile API at the specified location.\<br />\<br /> **Before** - immediately before the target function entry.\<br />\<br /> **After** - immediately after the target function exit.\<br />\<br /> **Top** - immediately after the target function entry.\<br />\<br /> **Bottom** - immediately before each return in the target function.\<br />\<br /> <CodeContentPlaceHolder>54\</CodeContentPlaceHolder> - name of the target function.\<br />\<br /> If the target function contains a StopProfile function, the ResumeProfile function is inserted after it.|  
  
## See Also  
 [VSPerfMon](../vs140/vsperfmon.md)   
 [VSPerfCmd](../vs140/vsperfcmd.md)   
 [VSPerfReport](../vs140/vsperfreport.md)   
 [VSInstr Warnings](../vs140/vsinstr-warnings.md)   
 [Profiling Tools Report Views](../vs140/performance-report-views.md)